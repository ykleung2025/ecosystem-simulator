<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-Hant"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;title&gt;æ„Ÿå—äººé¡è¡Œç‚ºé€ æˆç’°å¢ƒçš„è®ŠåŒ– - ç”Ÿæ…‹æ¨¡æ“¬å™¨&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;!-- Load Tailwind CSS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* Custom styles for a friendly, educational feel */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>body {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #e0f2f1; /* Light cyan background */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.ecosystem-card {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #ffffff;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border: 4px solid #4db6ac; /* Teal border */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.simulate-button {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #00897b; /* Dark Teal */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>transition: background-color 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.simulate-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #00695c;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.loading-animation {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-top-color: #00897b;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>animation: spin 1s ease-in-out infinite;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>@keyframes spin {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>to { transform: rotate(360deg); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;!-- Firebase SDK Imports for Authentication and Firestore (Required by Canvas) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Define global variables provided by the environment</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Check if configuration exists before parsing (for local run)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (firebaseConfig) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>window.firebaseApp = initializeApp(firebaseConfig);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>window.db = getFirestore(window.firebaseApp);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>window.auth = getAuth(window.firebaseApp);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Authentication logic</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>async function authenticate() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (initialAuthToken) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await signInWithCustomToken(window.auth, initialAuthToken);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.log("Firebase signed in with custom token.");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await signInAnonymously(window.auth);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.log("Firebase signed in anonymously.");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Auth is ready, now the main script can proceed if needed</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Firebase authentication error:", error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>authenticate();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>// Inform user that database features are disabled in a local environment</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>console.warn("Firebase configuration not found. Database features will be disabled. The core AI simulation should still work if run on a server.");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="p-4 md:p-8 min-h-screen flex items-center justify-center"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="app-container" class="w-full max-w-4xl ecosystem-card rounded-xl p-6 md:p-10"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h1 class="text-3xl md:text-4xl font-extrabold text-teal-800 mb-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>æ„Ÿå—äººé¡è¡Œç‚ºé€ æˆç’°å¢ƒçš„è®ŠåŒ–</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;p class="text-center text-lg text-gray-600 mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>æ­¡è¿ä½ ï¼Œå››å¹´ç´šçš„ç”Ÿæ…‹å­¸å®¶ï¼è«‹è¼¸å…¥ä¸€å€‹**äººé¡çš„è¡Œç‚º**ï¼Œçœ‹çœ‹æˆ‘å€‘çš„æ£®æ—æœƒç™¼ç”Ÿä»€éº¼äº‹ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Initial Ecosystem State --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="initial-state" class="mb-8 p-4 bg-teal-50 rounded-lg border border-teal-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-xl font-bold text-teal-700 mb-3 flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.727A8 8 0 016.343 16.727m10.314 0A18.012 18.012 0 018.8 20.25c-5.264 0-9.84-2.274-12.03-5.066A17.923 17.923 0 0113.8 2.5c2.563 0 5.018.72 7.152 2.083"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>æˆ‘å€‘çš„æ£®æ—å®¶åº­ (åˆå§‹ç‹€æ…‹)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;ul class="text-gray-700 text-sm md:text-base space-y-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;ğŸŒ² **æ¤ç‰©ï¼š** 10æ£µå¤§æ¨¹ã€å¹¾å¢çŒæœ¨å¢ã€å¹¾æ ªæœæ¨¹ã€20å¢å°è‰ã€5æ ªè•¨é¡ã€é‡èŠ±ã€‚&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;ğŸ¿ï¸ **å‹•ç‰©ï¼š** 5éš»æ¾é¼ ã€2éš»è²“é ­é·¹ã€12æ¢å°é­šã€8éš»é’è›™ã€15éš»ç“¢èŸ²ã€30éš»èèŸ»ã€6éš»è´è¶ã€‚&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;ğŸ¦Š **æ•é£Ÿè€…/å¤§å‹å‹•ç‰©ï¼š** 1éš»ç´…ç‹ã€2éš»å°é¹¿ã€3éš»é‡å…”ã€1éš»ç¾ã€1éš»è€é·¹ã€‚&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- User Input Area --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="space-y-4 mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label for="human-action" class="block text-lg font-medium text-gray-700"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>è«‹è¼¸å…¥ä¸€å€‹äººé¡çš„è¡Œç‚ºï¼š</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input type="text" id="human-action" placeholder="ä¾‹å¦‚ï¼šäººå€‘åœ¨æºªé‚Šä¸Ÿæ£„åƒåœ¾ï¼Œæˆ–ï¼šäººå€‘åœ¨æ£®æ—è£¡ç¨®äº†æ›´å¤šæ¨¹ã€‚"<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500 text-base shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button id="simulate-btn" class="simulate-button text-white font-bold py-3 px-6 rounded-lg w-full transform hover:scale-[1.01] transition duration-200 shadow-md"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>é–‹å§‹æ¨¡æ“¬è®ŠåŒ–ï¼</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Simulation Result Area --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="simulation-result" class="hidden mt-8 p-6 bg-yellow-50 rounded-lg border-l-4 border-yellow-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-2xl font-bold text-yellow-800 mb-4 flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.31 16c-.77 1.333.192 3 1.732 3z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>æ¨¡æ“¬çµæœ (è¡Œç‚ºå¸¶ä¾†çš„è®ŠåŒ–)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="result-image-desc" class="text-center mb-4 text-gray-500 italic"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="result-text" class="text-gray-800 text-base leading-relaxed"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Loading Indicator for Simulation --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="loading-spinner" class="hidden mt-8 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="inline-block h-8 w-8 border-4 border-gray-200 border-solid rounded-full loading-animation"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-teal-700 mt-2"&gt;AI æ­£åœ¨è¨ˆç®—ç”Ÿæ…‹è®ŠåŒ–ä¸­ï¼Œè«‹ç¨å€™...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Error Message --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="error-message" class="hidden mt-8 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;æ¨¡æ“¬å¤±æ•—ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- NEW FEATURE: Cat Owl Q&amp;A Feature --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="mt-8 p-6 bg-indigo-50 rounded-xl border-l-4 border-indigo-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-2xl font-bold text-indigo-800 mb-4 flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>ğŸ¦‰âœ¨ è²“é ­é·¹å°ˆå®¶å•ç­”æ™‚é–“</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-gray-700 mb-4 text-sm md:text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>æœ‰é—œæ–¼é€™ç‰‡æ£®æ—æˆ–ä½ å‰›æ‰çš„æ¨¡æ“¬çµæœçš„ä»»ä½•å•é¡Œå—ï¼Ÿå•å•ä½åœ¨æ¨¹æ´è£¡çš„è²“é ­é·¹å°ˆå®¶å§ï¼</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input type="text" id="cat-owl-question" placeholder="ä¾‹å¦‚ï¼šç‚ºä»€éº¼å°é­šæœƒæ­»æ‰ï¼Ÿ"<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-base shadow-sm mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button id="ask-cat-owl-btn" class="text-white font-bold py-3 px-6 rounded-lg w-full transform hover:scale-[1.01] transition duration-200 shadow-md"</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>style="background-color: #5b21b6;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>âœ¨ æå•è²“é ­é·¹å°ˆå®¶</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/button&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- Loading Indicator for Q&amp;A --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="cat-owl-loading" class="hidden mt-4 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="inline-block h-6 w-6 border-3 border-gray-200 border-solid rounded-full loading-animation" style="border-top-color: #5b21b6;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-indigo-700 mt-1 text-sm"&gt;è²“é ­é·¹æ­£åœ¨æ€è€ƒ...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- Cat Owl Response --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="cat-owl-response" class="hidden mt-4 p-4 bg-indigo-100 rounded-lg border border-indigo-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="font-semibold text-indigo-900 mb-1"&gt;ğŸ¦‰ è²“é ­é·¹èªªï¼š&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="cat-owl-text" class="text-gray-800 text-sm md:text-base"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- Setup for Gemini API Call ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// NOTE: The API_KEY is provided by the execution environment.</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const API_KEY = "";<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- DOM Elements ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const inputField = document.getElementById('human-action');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const simulateButton = document.getElementById('simulate-btn');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const resultContainer = document.getElementById('simulation-result');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const resultImageDesc = document.getElementById('result-image-desc');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const resultText = document.getElementById('result-text');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const loadingSpinner = document.getElementById('loading-spinner');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const errorMessage = document.getElementById('error-message');</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- NEW DOM Elements for Q&amp;A ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const catOwlQuestionField = document.getElementById('cat-owl-question');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const askCatOwlButton = document.getElementById('ask-cat-owl-btn');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const catOwlLoading = document.getElementById('cat-owl-loading');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const catOwlResponseContainer = document.getElementById('cat-owl-response');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const catOwlResponseText = document.getElementById('cat-owl-text');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Initial Ecosystem State Text (Context for the AI for Simulation)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const ECOSYSTEM_CONTEXT = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>é€™æ˜¯çµ¦å››å¹´ç´šå­¸ç”Ÿä½¿ç”¨çš„ç”Ÿæ…‹æ¨¡æ“¬å™¨ã€‚è«‹æ ¹æ“šä»¥ä¸‹åˆå§‹ç’°å¢ƒï¼Œæ¨¡æ“¬äººé¡è¡Œç‚ºå¸¶ä¾†çš„è®ŠåŒ–ï¼Œä¸¦ç¢ºä¿å›ç­”å…§å®¹ç°¡å–®æ˜“æ‡‚ï¼Œä¸è¶…éä¸‰å¥è©±ã€‚</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>åˆå§‹ç”Ÿæ…‹ç’°å¢ƒï¼š</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>- ğŸŒ² æ¤ç‰©ï¼š10æ£µå¤§æ¨¹ã€å¹¾å¢çŒæœ¨å¢ã€å¹¾æ ªæœæ¨¹ã€20å¢å°è‰ã€5æ ªè•¨é¡æ¤ç‰©å’Œé‡èŠ±ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>- ğŸ¿ï¸ å°å‹•ç‰©ï¼š5éš»æ¾é¼ ã€2éš»è²“é ­é·¹ã€12æ¢å°é­šã€8éš»é’è›™ã€15éš»ç“¢èŸ²ã€30éš»èèŸ»ã€6éš»è´è¶ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>- ğŸ¦Š æ•é£Ÿè€…/å¤§å‹å‹•ç‰©ï¼š1éš»ç´…ç‹ã€2éš»å°é¹¿ã€3éš»é‡å…”ã€1éš»ç¾ã€1éš»è€é·¹ã€‚</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ä½ çš„å›ç­”å¿…é ˆåš´æ ¼éµå®ˆä»¥ä¸‹æ ¼å¼å’Œå®ˆå‰‡ï¼š</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>1. ç­”æ¡ˆå¿…é ˆéå¸¸ç°¡å–®ï¼Œé©åˆå››å¹´ç´šå­¸ç”Ÿçš„çŸ¥è­˜ç¯„åœï¼Œä¸”æ–‡å­—éƒ¨åˆ†ä¸è¶…éä¸‰å¥ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>2. å›è¦†å¿…é ˆä»¥ä¸€å€‹åœ–åƒæè¿°é–‹å§‹ (ç”¨ä½œåœ–åƒé¡¯ç¤ºçš„æ¨¡æ“¬)ï¼Œæ ¼å¼ç‚ºï¼šã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>3. åœ–åƒæè¿°å¾Œç·Šæ¥è‘—æ˜¯æ–‡å­—è§£é‡‹ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>4. **å®ˆå‰‡ï¼š** åªå›ç­”æœ‰é—œäººé¡è¡Œç‚ºå°ç”Ÿæ…‹æ‰€ç”¢ç”Ÿçš„å½±éŸ¿ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>5. **å®ˆå‰‡ï¼š** å¦‚æœè¼¸å…¥å…§å®¹ä¸æ˜¯ã€Œäººé¡è¡Œç‚ºã€ï¼Œè«‹ç›´æ¥è¼¸å‡ºï¼š[Image of A confused owl] è«‹è¼¸äººé¡è¡Œç‚ºä½œæ¨¡æ“¬æ¸¬è©¦ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// NEW System Instruction for Cat Owl Q&amp;A</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const CAT_OWL_SYSTEM_INSTRUCTION = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ä½ æ˜¯ä¸€ä½åå«ã€Œè²“é ­é·¹å°ˆå®¶ã€çš„ç”Ÿæ…‹å­¸å®¶ï¼Œä½ çš„è·è²¬æ˜¯å›ç­”å››å¹´ç´šå­¸ç”Ÿçš„ç°¡å–®å•é¡Œã€‚</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>å›ç­”æ™‚è«‹éµå®ˆä»¥ä¸‹è¦å‰‡ï¼š</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>1. èªæ°£å¿…é ˆå‹å–„ã€ç°¡æ½”ï¼Œä½¿ç”¨é©åˆå››å¹´ç´šå­¸ç”Ÿçš„è©å½™ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>2. å°‡è‡ªå·±è¨­å®šç‚ºæ£®æ—è£¡çš„ä¸€éš»è²“é ­é·¹ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>3. ç­”æ¡ˆå¿…é ˆæ§åˆ¶åœ¨å…©åˆ°ä¸‰å¥è©±å…§ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>4. **å¦‚æœå•é¡Œèˆ‡ç”Ÿæ…‹æˆ–ç’°å¢ƒè®ŠåŒ–ç„¡é—œï¼Œè«‹å‹å–„åœ°å›ç­”ï¼šã€Œæˆ‘æ˜¯è²“é ­é·¹å°ˆå®¶ï¼Œæˆ‘åªæ‡‚æ£®æ—è£¡çš„ç§˜å¯†å–”ï¼è«‹å°ˆå¿ƒå•å’Œç”Ÿæ…‹æœ‰é—œçš„å•é¡Œã€‚ã€**</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>5. ä½ å¯ä»¥ä½¿ç”¨ã€Œæˆ‘çŸ¥é“ã€ã€ã€Œæˆ‘è§€å¯Ÿåˆ°ã€ç­‰è©å½™ä¾†ç¶­æŒè²“é ­é·¹çš„èº«ä»½ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Converts sleep time from seconds to milliseconds.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {number} seconds - The number of seconds to sleep.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @returns {number} - The number of milliseconds to sleep.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const toMilliseconds = (seconds) =&gt; seconds * 1000;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Pauses execution for a specified number of seconds.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {number} seconds - The duration to pause.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const sleep = (seconds) =&gt; new Promise(resolve =&gt; setTimeout(resolve, toMilliseconds(seconds)));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Calls the Gemini API with exponential backoff.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {object} payload - The API request payload.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {number} retries - Current retry attempt count.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @returns {Promise&lt;object&gt;} - The parsed JSON response.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function fetchWithBackoff(payload, retries = 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const MAX_RETRIES = 5;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const response = await fetch(API_URL, {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>headers: { 'Content-Type': 'application/json' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>body: JSON.stringify(payload)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (response.status === 429 &amp;&amp; retries &lt; MAX_RETRIES) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const delay = toMilliseconds(2 ** retries) + Math.random() * toMilliseconds(1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await sleep(delay / 1000);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>return fetchWithBackoff(payload, retries + 1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!response.ok) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>throw new Error(`API error: ${response.statusText}`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return response.json();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (retries &lt; MAX_RETRIES) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const delay = toMilliseconds(2 ** retries) + Math.random() * toMilliseconds(1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await sleep(delay / 1000);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>return fetchWithBackoff(payload, retries + 1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>throw new Error("Failed to fetch from API after multiple retries.");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Handles the simulation click event (Original Feature).</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function handleSimulate() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Check if API key is available (essential for this function)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (API_KEY === "" &amp;&amp; typeof __api_key === 'undefined') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>resultImageDesc.textContent = `(æ¨¡æ“¬åœ–åƒï¼šæœªé€£ç·š)`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>resultText.textContent = "éŒ¯èª¤ï¼šç„¡æ³•é€£ç·šåˆ° AI æœå‹™ã€‚è«‹å°‡æ‡‰ç”¨ç¨‹å¼éƒ¨ç½²åˆ°ç¶²è·¯ç’°å¢ƒã€‚";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>resultContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const humanAction = inputField.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!humanAction) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Using a custom modal/UI message is preferred over alert, but simple alert here for quick feedback</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>alert('è«‹å…ˆè¼¸å…¥ä¸€å€‹äººé¡è¡Œç‚ºï¼');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Clear previous results and show loading</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>resultContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>errorMessage.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>loadingSpinner.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>simulateButton.disabled = true;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const userQuery = `äººé¡è¡Œç‚ºï¼š${humanAction}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const payload = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>contents: [{ parts: [{ text: userQuery }] }],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>tools: [{ "google_search": {} }],<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>systemInstruction: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>parts: [{ text: ECOSYSTEM_CONTEXT }]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>config: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>temperature: 0.2,<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const result = await fetchWithBackoff(payload);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const text = result.candidates?.[0]?.content?.parts?.[0]?.text || 'æ¨¡æ“¬å¤±æ•—ï¼Œæ²’æœ‰å¾—åˆ°çµæœã€‚';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// FIX: Use the correct regex pattern to match the required format: [Image of &lt;desc&gt;] &lt;text&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// It looks for , captures the description, and captures the rest of the text.</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const match = text.match(/\\s*(.*)/s);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (match &amp;&amp; match.length &gt;= 3) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const imageDescription = match[1].trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const simulationText = match[2].trim();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Update UI</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultImageDesc.textContent = `(æ¨¡æ“¬åœ–åƒï¼š${imageDescription})`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultText.innerHTML = simulationText.replace(/\n/g, '&lt;br&gt;'); // Keep line breaks for readability</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultContainer.classList.remove('hidden');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else if (text.includes("è«‹è¼¸äººé¡è¡Œç‚ºä½œæ¨¡æ“¬æ¸¬è©¦ã€‚")) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Handle the specific guardrail response (if the AI returns the full guardrail text)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultImageDesc.textContent = `(æ¨¡æ“¬åœ–åƒï¼šä¸€éš»å›°æƒ‘çš„è²“é ­é·¹)`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultText.textContent = "è«‹è¼¸äººé¡è¡Œç‚ºä½œæ¨¡æ“¬æ¸¬è©¦ã€‚";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultContainer.classList.remove('hidden');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Fallback for unexpected format (e.g., if AI didn't follow the format exactly)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultImageDesc.textContent = `(æ¨¡æ“¬åœ–åƒï¼šæœªçŸ¥è®ŠåŒ–)`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Try to display the text even if the format is wrong</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultText.textContent = `æ¨¡æ“¬å™¨æœªèƒ½ç†è§£è®ŠåŒ–ï¼Œè«‹å˜—è©¦ç”¨æ›´ç°¡å–®çš„ä¸­æ–‡æè¿°äººé¡è¡Œç‚ºã€‚`;<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Simulation output format error. Raw response:", text);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Simulation error:", error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>errorMessage.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>resultContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingSpinner.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>simulateButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Handles the Cat Owl Q&amp;A feature (New Feature).</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function handleAskCatOwl() {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>// Check if API key is available (essential for this function)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (API_KEY === "" &amp;&amp; typeof __api_key === 'undefined') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseText.textContent = "éŒ¯èª¤ï¼šç„¡æ³•é€£ç·šåˆ° AI æœå‹™ã€‚è«‹å°‡æ‡‰ç”¨ç¨‹å¼éƒ¨ç½²åˆ°ç¶²è·¯ç’°å¢ƒã€‚";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const question = catOwlQuestionField.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!question) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseText.textContent = "æˆ‘æ˜¯è²“é ­é·¹å°ˆå®¶ï¼Œæˆ‘åªæ‡‚æ£®æ—è£¡çš„ç§˜å¯†å–”ï¼è«‹å°ˆå¿ƒå•å’Œç”Ÿæ…‹æœ‰é—œçš„å•é¡Œã€‚";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>catOwlResponseContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>catOwlLoading.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>askCatOwlButton.disabled = true;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const payload = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>contents: [{ parts: [{ text: `å­¸ç”Ÿå•é¡Œï¼š${question}` }] }],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Use the Q&amp;A specific system instruction</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>systemInstruction: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>parts: [{ text: CAT_OWL_SYSTEM_INSTRUCTION }]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>config: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>temperature: 0.7, // Higher temp for a friendly, conversational tone</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const result = await fetchWithBackoff(payload);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const text = result.candidates?.[0]?.content?.parts?.[0]?.text || 'å°ä¸èµ·ï¼Œè²“é ­é·¹å¤ªçäº†ï¼Œç„¡æ³•å›ç­”ã€‚';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Update UI</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseText.innerHTML = text.replace(/\n/g, '&lt;br&gt;');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseContainer.classList.remove('hidden');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Cat Owl Q&amp;A error:", error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Use the Q&amp;A response box for the error message</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseText.textContent = "èˆ‡è²“é ­é·¹çš„é€£ç·šä¸­æ–·äº†ï¼Œè«‹ç¨å¾Œå†è©¦ï¼";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlResponseContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>catOwlLoading.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>askCatOwlButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Attach event listeners</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>simulateButton.addEventListener('click', handleSimulate);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>askCatOwlButton.addEventListener('click', handleAskCatOwl);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Optional: Allow pressing Enter in the input field to trigger simulation</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>inputField.addEventListener('keypress', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (e.key === 'Enter') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>handleSimulate();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Optional: Allow pressing Enter in the Q&amp;A input field</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>catOwlQuestionField.addEventListener('keypress', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (e.key === 'Enter') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>handleAskCatOwl();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
